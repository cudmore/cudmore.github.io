<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Mounting a USB drive at boot &middot; Robert Cudmore
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!--
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  -->
  
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <!-- added 20151219 -->
  <link rel="alternate" type="application/rss+xml" title="My Site RSS" href="/feed.xml" />

  <!-- added 20171023 -->
    

</head>





  <body class="layout-reverse">

    <div class="sidebar">
  <!-- <div class="container sidebar-sticky"> %} -->

    
    
    <div id="sidebar">
    <!-- <nav class="sidebar-nav"> -->
      <!-- <a class="sidebar-nav-item" href="">Home</a> -->

      

	  <!-- <script>
  (function() {
    var cx = '014838221913568838622:5bpsoltbvmg';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
 -->
		
		<BR>
		<BR>
		
		<section id="article">
		  <span class="sidebar-nav-item">Posts</span>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/11/27/startup-mailer/">Startup mailer on a Raspberry Pi</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/11/21/raspian-stretch/">Installing Raspian Stretch on a Raspberry Pi</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/31/libav-for-ffmpeg/">libav for ffmpeg</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/26/Raspberry-startup-tweet/">Raspberry startup tweet</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/21/Home-debian-server-setup/">Home Debian server setup</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/16/Home-cage-activity/">Home Cage Activity</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/03/10/google-cloud-platform/">Google Cloud Platform</a><BR>
		    
		</section>

		<BR>

		<span class="sidebar-nav-item">Tags</span>
		
    		<a style="font-size: 102%" href="/tags/#flask">
    		  flask
    		</a>
		
    		<a style="font-size: 115%" href="/tags/#python">
    		  python
    		</a>
		
    		<a style="font-size: 140%" href="/tags/#raspberry pi">
    		  raspberry pi
    		</a>
		
    		<a style="font-size: 90%" href="/tags/#data acquisition">
    		  data acquisition
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#bokeh">
    		  bokeh
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#protocols">
    		  protocols
    		</a>
		
    		<a style="font-size: 90%" href="/tags/#osx">
    		  osx
    		</a>
		
    		<a style="font-size: 252%" href="/tags/#raspberry">
    		  raspberry
    		</a>
		
    		<a style="font-size: 290%" href="/tags/#linux">
    		  linux
    		</a>
		
    		<a style="font-size: 115%" href="/tags/#arduino">
    		  arduino
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#ScanImage">
    		  ScanImage
    		</a>
		
    		<a style="font-size: 77%" href="/tags/#jekyll">
    		  jekyll
    		</a>
		
    		<a style="font-size: 140%" href="/tags/#debian">
    		  debian
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#github">
    		  github
    		</a>
		
    		<a style="font-size: 65%" href="/tags/#video">
    		  video
    		</a>
		
    		<a style="font-size: 77%" href="/tags/#analysis">
    		  analysis
    		</a>
		

		<BR>
		<BR>

		<section id="article">
		  <span class="sidebar-nav-item">
		  	Links 
			</span>
		  &raquo; <a class="sidebarlink" href="http://robertcudmore.org">robertcudmore.org</a><BR>
		  &raquo; <a class="sidebarlink" href="http://github.com/cudmore">github.com/cudmore</a><BR>
		  &raquo; <a class="sidebarlink" href="http://www.flickr.com/cudmore">flickr.com/cudmore</a><BR>
		  <!-- <a href="http://blog.cudmore.io/feed.xml"><IMG ALIGN=LEFT WIDTH=20 HEIGHT=20 SRC="images/feed-icon.png"></a><BR> -->
		  
		</section>
  
	</div>
<!--    </nav> -->

  <!-- </div> %} -->
</div>


    <div class="content container">

      <!-- added by bob -->
      <div class="masthead-title">
	      <h3 class="post-title">
	      <span style="font-size:24px;">
          <a href="/" title="Home">Robert Cudmore</a>
		  </span>
		  
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/archive">archive</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/archive">archive</a></small> -->
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/tags">tags</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/tags">tags</a></small> -->
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/search">search</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/search">search</a></small> -->
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/software">software</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/software">software</a></small> -->
          
		</h3>

		<hr style="background:#202020; border:0; height:3px" />
		
      </div>

      <div class="post">
  <h2 class="post-title">Mounting a USB drive at boot</h2>
  <span class="post-date">05 May 2015</span>
  <p>I have a Fat32 formatted USB drive and I want to have it mounted when the Raspberry Pi boots. To do this I add an entry to my fstab file using the UUID of the drive and some permission.</p>

<h4 id="get-a-list-of-your-usb-devices-to-check-if-your-usb-drive-is-available">Get a list of your USB devices to check if your USB drive is available</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>lsusb

Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp.
Bus 001 Device 004: ID 13fe:5200 Kingston Technology Company Inc.
Bus 001 Device 005: ID 0bda:8176 Realtek Semiconductor Corp. RTL8188CUS 802.11n WLAN Adapter
</code></pre>
</div>

<h4 id="make-a-directory-to-mount-your-drivevolume-into">Make a directory to mount your drive/volume into</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo mkdir /home/pi/crap
</code></pre>
</div>

<h4 id="find-the-uuid-of-your-drive">Find the UUID of your drive</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo blkid

/dev/mmcblk0p1: SEC_TYPE="msdos" LABEL="boot" UUID="2654-BFC0" TYPE="vfat"
/dev/mmcblk0p2: UUID="548da502-ebde-45c0-9ab2-de5e2431ee0b" TYPE="ext4"
/dev/sda1: LABEL="CRAP" UUID="7CCD-19F2" TYPE="vfat"
</code></pre>
</div>

<p>This tells me that my usb drive is in the device list at /dev/sda1, has the label ‘crap’, a UUID of ’7CCD-19F2′, and is formatted as VFAT (e.g. FAT32).</p>

<h4 id="edit-your-etcfstab-file-by-appending-a-line-for-your-dive">Edit your /etc/fstab file by appending a line for your dive</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo pico /etc/fstab

proc            /proc           proc    defaults          0       0
/dev/mmcblk0p1  /boot           vfat    defaults          0       2
/dev/mmcblk0p2  /               ext4    defaults,noatime  0       1
UUID=7CCD-19F2 /home/pi/crap    vfat    rw,umask=0      0       0
# a swapfile is not a swap partition, so no using swapon|off from here on, use $
</code></pre>
</div>

<p>Here, on the line starting with UUID, I have mounted a device using its UUID=7CCD-19F2 into a folder /home/pi/crap. This is a Fat32 formatted drive (vfat) and everybody has read-write permissions (rw,umask=0). This recipe will not work for other types of formatted drives (Ext3, NTFS, etc).</p>

<h4 id="remount-your-drives-and-check-the-drive-is-mounted">Remount Your drives and check the drive is mounted</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo mount -a
</code></pre>
</div>

<p>‘ls’ should show /video/ in blue to indicate it is mounted</p>

<p>Important. When you make the directory where a drive will be mounted it MUST be done with ‘sudo mkdir /home/pi/crap’. You need ‘sudo’ so fstab can mount it on boot, the final permissions of this mounted drive are set in the drives fstab line. In this case, ‘rw,umask=0′.</p>

<h4 id="linux-commands">Linux Commands</h4>

<ul>
  <li>
    <p>List your usb devices: lsusb</p>
  </li>
  <li>
    <p>List the Location, Label, UUID and Type of your USB devices: sudo blkid</p>
  </li>
  <li>
    <p>Unmount a volume: sudo umount /home/pi/crap</p>
  </li>
  <li>
    <p>Mount everybody in fstab: sudo mount -a</p>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Check if a drive is mounted: df</td>
          <td>grep “/home/pi/video”</td>
          <td>awk ‘{print $6}’</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h4 id="to-do">To Do</h4>

<ul>
  <li>
    <p>A problem I just had is that my USB drive did not get mounted at boot and the folder I have reserved for it is on my root file system, ‘/’,  with only 4 GB of space. I started writing tons of video files to the folder and quickly ran out of space on. Now, I need a way to test if the folder I am writing to is (I) a folder or (ii) an actual mount point. Tym, the bash guru in the lab and my go to person on these things suggested the following:</p>

    <table>
      <tbody>
        <tr>
          <td>df</td>
          <td>grep “/home/pi/video”</td>
          <td>awk ‘{print $6}’</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p>This will return an empty string if /home/pi/video is NOT mounted.</p>


</div>

<div class="post-tags">
  Tags: 
  
  
  <a href="/tags/#linux">linux</a>,
  
  <a href="/tags/#raspberry">raspberry</a>
  
</div>


<div class="post-tags">
    <p><font size="-1rem">&copy;2017. <A HREF="http://robertcudmore.org">Robert Cudmore</A>.</font></p>
</div>


<span class="page-nav-item-left">
    <a rel="prev" href="/post/2015/05/05/X11-on-Raspberry/" title="View X11 on raspberry">&laquo; Older</a>
</span>


<span class="page-nav-item-right">
    <a rel="next" href="/post/2015/05/24/Non-blocking-stepper-motor-on-arduino/" title="View ">Newer &raquo;</a>
</span>



    </div>


  </body>
</html>
