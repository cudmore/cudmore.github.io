<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      particle cloud &middot; Robert Cudmore
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!--
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  -->
  
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>





  <body class="layout-reverse">

    <div class="sidebar">
  <div class="container sidebar-sticky">

    
    
    <div id="sidebar">
    <!-- <nav class="sidebar-nav"> -->
      <!-- <a class="sidebar-nav-item" href="">Home</a> -->

      

	  <!-- <script>
  (function() {
    var cx = '014838221913568838622:5bpsoltbvmg';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
 -->

		<section id="article">
		  <span class="sidebar-nav-item">Recent posts</span>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/12/01/particle-cloud-server/">particle cloud</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/11/07/debian-server/">debian server</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/09/07/remote-sensors/">remote sensors</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/09/04/simple-form/">simple form in jekyll</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/08/14/PyQtGraph-to-display-a-stack/">pyqtGraph to display a .tif stack</a><BR>
		    
		</section>

		<BR>

		<span class="sidebar-nav-item">Tag cloud</span>
		
    		<a style="font-size: 90%" href="/tags/#flask">
    		  flask
    		</a>
		
    		<a style="font-size: 140%" href="/tags/#python">
    		  python
    		</a>
		
    		<a style="font-size: 173%" href="/tags/#raspberry pi">
    		  raspberry pi
    		</a>
		
    		<a style="font-size: 106%" href="/tags/#data acquisition">
    		  data acquisition
    		</a>
		
    		<a style="font-size: 56%" href="/tags/#bokeh">
    		  bokeh
    		</a>
		
    		<a style="font-size: 56%" href="/tags/#protocols">
    		  protocols
    		</a>
		
    		<a style="font-size: 106%" href="/tags/#osx">
    		  osx
    		</a>
		
    		<a style="font-size: 106%" href="/tags/#raspberry">
    		  raspberry
    		</a>
		
    		<a style="font-size: 156%" href="/tags/#linux">
    		  linux
    		</a>
		
    		<a style="font-size: 90%" href="/tags/#arduino">
    		  arduino
    		</a>
		
    		<a style="font-size: 56%" href="/tags/#ScanImage">
    		  ScanImage
    		</a>
		
    		<a style="font-size: 56%" href="/tags/#jekyll">
    		  jekyll
    		</a>
		

		<BR>
		<BR>

		<section id="article">
		  <span class="sidebar-nav-item">Links</span>
		  &raquo; <a class="sidebarlink" href="http://robertcudmore.org">robertcudmore.org</a><BR>
		  &raquo; <a class="sidebarlink" href="http://github.com/cudmore">github.com/cudmore</a><BR>
		  &raquo; <a class="sidebarlink" href="http://www.flickr.com/cudmore">flickr.com/cudmore</a><BR>
		</section>
  
	</div>
<!--    </nav> -->

  </div>
</div>


    <div class="content container">

      <!-- added by bob -->
      <div class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">Robert Cudmore</a>

          
              &nbsp;&nbsp;&nbsp;<small><a href="/about">about</a></small>
          
              &nbsp;&nbsp;&nbsp;<small><a href="/archive">archive</a></small>
          
              &nbsp;&nbsp;&nbsp;<small><a href="/tags">tags</a></small>
          
              &nbsp;&nbsp;&nbsp;<small><a href="/software">software</a></small>
          


        </h3>
		<hr style="background:#202020; border:0; height:3px" />
      </div>

      <div class="post">
  <h3 class="post-title">particle cloud</h1>
  <span class="post-date">01 Dec 2015</span>
  <p>Photon-B83V</p>

<h4>This is not working...</h4>

<p>The paticle photon is a great little wifi enabled arduino. The only problem I have is that all read/write using its REST API requires internet acces to a particle.io account. To get around this, you can run a particle cloud server locally.</p>

<p>I am doing all of this on a Debian Jessie server.</p>

<h4>install git</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install git
</code></pre></div>
<h4>install nodejs (use su to enter su/root)</h4>

<p>Following: <a href="https://github.com/nodesource/distributions">https://github.com/nodesource/distributions</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">curl -sL https://deb.nodesource.com/setup_4.x | bash -
apt-get install -y nodejs
</code></pre></div>
<h4>Install particle cli</h4>

<p>Following: <a href="https://github.com/spark/particle-cli">https://github.com/spark/particle-cli</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo npm install -g particle-cli
</code></pre></div>
<h4>Install particle cloud server</h4>

<p>Following: <a href="https://github.com/spark/spark-server/">https://github.com/spark/spark-server/</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">git clone https://github.com/spark/spark-server.git
cd spark-server
npm install
node main.js
</code></pre></div>
<p>&#39;node main.js&#39; produced</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">-------
No users exist, you should create some users!
-------
connect.multipart() will be removed in connect 3.0
visit https://github.com/senchalabs/connect/wiki/Connect-3.0 for alternatives
connect.limit() will be removed in connect 3.0
Starting server, listening on 8080
static class init!
core keys directory didn&#39;t exist, creating... /home/cudmore/spark-server/core_keys
Creating NEW server key
Loading server key from default_key.pem
set server key
server public key is:  -----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz3oPu+QsNdQaVgk+e4nS
zmTxop7vVamrKdIpio04yoY9pKPmkORAmM0VdFgYKinn094cHERm+LFdDhSAtWtn
TIErdd3o2ntoyZoYLC30Q2Mwvb+AzvGRcrW7jk+72up6YbXMZi2lhRs9M5Qe7use
mXy96PiRP7tYD+Yj+k0t3bDF+lfiWHuuG/yV2/hQaQ8ADfqtWvX4XyLMC9XS2m94
HhFy83sWPcRcB7BZUr1A8w503vB+gZWlt8W+uPlbUmbF+P8LzZmE4Twn87EcMeTB
qGvBxjWypHF95jDzZCie5/glZtunmH905Lb12y1eWLY29KPPk8BcpIzPJ5xc8mKk
gQIDAQAB
-----END PUBLIC KEY-----

Your server IP address is: 192.168.1.200
server started { host: &#39;localhost&#39;, port: 5683 }
</code></pre></div>
<h4>Continue setting up particle server</h4>

<p>Install <a href="http://dfu-util.sourceforge.net">dfu-utils</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    #git clone git://git.code.sf.net/p/dfu-util/dfu-util
    sudo apt-get build-dep dfu-util
    sudo apt-get install libusb-1.0-0-dev
</code></pre></div>
<p>But that did not work so i did</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get upgrade dfu-til
</code></pre></div>
<p>This updated a boat load of things including jre and owncloud (leaving it in maintenance mode). To turn owncloud maintenance mode off, follow <a href="https://doc.owncloud.org/server/8.0/admin_manual/maintenance/enable_maintenance.html">this</a> and edit /var/www/owncloud/config/config.php and set &#39;maintenance&#39; =&gt; false,&#39;. The next itme I logged into my owncloud server it triggered an update to 8.2.1</p>

<p>Try again with particle photon plugged in via usb</p>

<p>Still following: <a href="https://github.com/spark/spark-server/">https://github.com/spark/spark-server/</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">particle keys server default_key.pub.pem 192.168.1.10
</code></pre></div>
<p>gave</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">cudmore@debian:~/spark-server$ sudo particle keys server default_key.pub.pem 192.168.1.200
running dfu-util -l
Found DFU device 2b04:d006
checking file  default_key.pub192_168_1_200.der
spawning dfu-util -d 2b04:d006 -a 1 -i 0 -s 2082 -D default_key.pub192_168_1_200.der
dfu-util 0.8

Copyright 2005-2009 Weston Schmidt, Harald Welte and OpenMoko Inc.
Copyright 2010-2014 Tormod Volden and Stefan Schmidt
This program is Free Software and has ABSOLUTELY NO WARRANTY
Please report bugs to dfu-util@lists.gnumonks.org

dfu-util: Invalid DFU suffix signature
dfu-util: A valid DFU suffix will be required in a future dfu-util release!!!
Opening DFU capable USB device...
ID 2b04:d006
Run-time device DFU version 011a
Claiming USB DFU Interface...
Setting Alternate Setting #1 ...
Determining device status: state = dfuIDLE, status = 0
dfuIDLE, continuing
DFU mode device DFU version 011a
Device returned transfer size 4096
DfuSe interface name: &quot;DCT Flash   &quot;
Downloading to address = 0x00000822, size = 1024
Download    [=========================] 100%         1024 bytes
Download done.
File downloaded successfully
Okay!  New keys in place, your device will not restart.
</code></pre></div>
</div>

<div class="post-tags">
  Tags: 
  
    
  
  
  <a href="/tags/#osx">osx</a>,
  
  <a href="/tags/#linux">linux</a>,
  
  <a href="/tags/#arduino">arduino</a>
  
</div>


<div class="post-tags">
    <p><font size="-1rem">&copy;2015. <A HREF="http://robertcudmore.org">Robert Cudmore</A>.</font></p>
</div>


<span class="page-nav-item-left">
    <a rel="prev" href="/post/2015/11/07/debian-server/" title="View debian server">&laquo; Older</a>
</span>




    </div>

  </body>
</html>
