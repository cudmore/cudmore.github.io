<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      debian server &middot; Robert Cudmore
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!--
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  -->
  
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <!-- added 20151219 -->
  <link rel="alternate" type="application/rss+xml" title="My Site RSS" href="/feed.xml" />

  <!-- added 20171023 -->
    

</head>





  <body class="layout-reverse">

    <div class="sidebar">
  <!-- <div class="container sidebar-sticky"> %} -->

    
    
    <div id="sidebar">
    <!-- <nav class="sidebar-nav"> -->
      <!-- <a class="sidebar-nav-item" href="">Home</a> -->

      

	  <!-- <script>
  (function() {
    var cx = '014838221913568838622:5bpsoltbvmg';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
 -->
		
		<BR>
		<BR>
		
		<section id="article">
		  <span class="sidebar-nav-item">Posts</span>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/11/27/startup-mailer/">Startup mailer on a Raspberry Pi</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/11/21/raspian-stretch/">Installing Raspian Stretch on a Raspberry Pi</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/31/libav-for-ffmpeg/">libav for ffmpeg</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/26/Raspberry-startup-tweet/">Raspberry startup tweet</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/21/Home-debian-server-setup/">Home Debian server setup</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/10/16/Home-cage-activity/">Home Cage Activity</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2017/03/10/google-cloud-platform/">Google Cloud Platform</a><BR>
		    
		</section>

		<BR>

		<span class="sidebar-nav-item">Tags</span>
		
    		<a style="font-size: 102%" href="/tags/#flask">
    		  flask
    		</a>
		
    		<a style="font-size: 115%" href="/tags/#python">
    		  python
    		</a>
		
    		<a style="font-size: 140%" href="/tags/#raspberry pi">
    		  raspberry pi
    		</a>
		
    		<a style="font-size: 90%" href="/tags/#data acquisition">
    		  data acquisition
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#bokeh">
    		  bokeh
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#protocols">
    		  protocols
    		</a>
		
    		<a style="font-size: 90%" href="/tags/#osx">
    		  osx
    		</a>
		
    		<a style="font-size: 252%" href="/tags/#raspberry">
    		  raspberry
    		</a>
		
    		<a style="font-size: 290%" href="/tags/#linux">
    		  linux
    		</a>
		
    		<a style="font-size: 115%" href="/tags/#arduino">
    		  arduino
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#ScanImage">
    		  ScanImage
    		</a>
		
    		<a style="font-size: 77%" href="/tags/#jekyll">
    		  jekyll
    		</a>
		
    		<a style="font-size: 140%" href="/tags/#debian">
    		  debian
    		</a>
		
    		<a style="font-size: 52%" href="/tags/#github">
    		  github
    		</a>
		
    		<a style="font-size: 65%" href="/tags/#video">
    		  video
    		</a>
		
    		<a style="font-size: 77%" href="/tags/#analysis">
    		  analysis
    		</a>
		

		<BR>
		<BR>

		<section id="article">
		  <span class="sidebar-nav-item">
		  	Links 
			</span>
		  &raquo; <a class="sidebarlink" href="http://robertcudmore.org">robertcudmore.org</a><BR>
		  &raquo; <a class="sidebarlink" href="http://github.com/cudmore">github.com/cudmore</a><BR>
		  &raquo; <a class="sidebarlink" href="http://www.flickr.com/cudmore">flickr.com/cudmore</a><BR>
		  <!-- <a href="http://blog.cudmore.io/feed.xml"><IMG ALIGN=LEFT WIDTH=20 HEIGHT=20 SRC="images/feed-icon.png"></a><BR> -->
		  
		</section>
  
	</div>
<!--    </nav> -->

  <!-- </div> %} -->
</div>


    <div class="content container">

      <!-- added by bob -->
      <div class="masthead-title">
	      <h3 class="post-title">
	      <span style="font-size:24px;">
          <a href="/" title="Home">Robert Cudmore</a>
		  </span>
		  
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/archive">archive</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/archive">archive</a></small> -->
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/tags">tags</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/tags">tags</a></small> -->
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/search">search</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/search">search</a></small> -->
          
              <span style="font-size:medium;">
              &nbsp;&nbsp;&nbsp;<a href="/software">software</a>
              </span>
              
              <!-- &nbsp;&nbsp;&nbsp;<small><a href="/software">software</a></small> -->
          
		</h3>

		<hr style="background:#202020; border:0; height:3px" />
		
      </div>

      <div class="post">
  <h2 class="post-title">debian server</h2>
  <span class="post-date">07 Nov 2015</span>
  <p>Goal is to set up a home server running Debain Jessie.</p>

<ul>
  <li>Share files with afp and smb</li>
  <li>Run basic python scripts</li>
  <li>Run flask servers on various ports</li>
  <li>Run an apache web server (not really set up)</li>
  <li>Run owncloud (synch clients are still slow)</li>
  <li>Run transmission for torrent download</li>
</ul>

<h3 id="the-hardware-is-as-follows">0) The hardware is as follows</h3>

<ul>
  <li>See my pcpartspicker <a href="http://pcpartpicker.com/p/PRq8Vn">inventory</a></li>
  <li>Processor: Intel Pentium G3258 3.2GHz Dual-Core Processor</li>
  <li>Motherboard: Gigabyte GA-H97N-WIFI Mini ITX LGA1150 Motherboard</li>
  <li>RAM: G.Skill Sniper Series 8GB (2 x 4GB) DDR3-1866 Memory</li>
  <li>Case: Cooler Master Elite 110 Mini ITX Tower Case</li>
  <li>Power: EVGA 430W 80+ Certified ATX</li>
</ul>

<h3 id="download-and-install-debian">1) Download and install debian</h3>

<ul>
  <li>Download debian jessie</li>
  <li>Make a usb key</li>
  <li>Install debian</li>
  <li>
    <p>Check your debian version</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>cat /etc/debian_version 
8.2
</code></pre>
    </div>
  </li>
</ul>

<h3 id="configure-debian-jessie">2) Configure debian jessie</h3>

<h4 id="update-your-repositories">Update your repositories</h4>

<p><code class="highlighter-rouge">
  apt-get update
 </code></p>

<h4 id="ssh">ssh</h4>

<p><code class="highlighter-rouge">
  apt-get install openssh-server
 </code></p>

<ul>
  <li>Follow <a href="https://wiki.debian.org/SSH# Installation_of_the_server">this</a></li>
</ul>

<h4 id="sudo">Sudo</h4>
<ul>
  <li>Use apt-get to install sudo. This is better then switching to su.</li>
  <li>Follow <a href="https://wiki.debian.org/sudo">this</a>.</li>
</ul>

<h4 id="add-in-a-second-hard-drive">Add in a second hard drive</h4>

<ul>
  <li>
    <p>partition</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>cfdisk /dev/sdb
</code></pre>
    </div>
  </li>
  <li>
    <p>format</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>mkfs.ext4 /dev/sdb1
</code></pre>
    </div>
  </li>
  <li>
    <p>Once disk is partitioned and formatted, this is what it looks like</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">cudmore@debian:~$ </span>sudo fdisk -l /dev/sdb
Disk /dev/sdb: 1.8 TiB, 2000398934016 bytes, 3907029168 sectors
Units: sectors of 1 <span class="k">*</span> 512 <span class="o">=</span> 512 bytes
Sector size <span class="o">(</span>logical/physical<span class="o">)</span>: 512 bytes / 512 bytes
I/O size <span class="o">(</span>minimum/optimal<span class="o">)</span>: 512 bytes / 512 bytes
Disklabel <span class="nb">type</span>: gpt
Disk identifier: 8B1D619B-4B38-44AE-AEE1-0180F07FC75F
  
Device     Start        End    Sectors  Size Type
/dev/sdb1   2048 3907029134 3907027087  1.8T Linux filesystem
</code></pre>
    </div>
  </li>
  <li>
    <p>Mount the second harddrive in a folder /movies</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>mkdir /movies <span class="c"># remember to set group and group rwx later</span>
mount -t ext4 /dev/sdb1 /movies
</code></pre>
    </div>
  </li>
  <li>
    <p>blkid to get unique name for fstab entry</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">cudmore@debian:~$ </span>sudo blkid
/dev/sda1: <span class="nv">UUID</span><span class="o">=</span><span class="s2">"30EE-7B6B"</span> <span class="nv">TYPE</span><span class="o">=</span><span class="s2">"vfat"</span> <span class="nv">PARTUUID</span><span class="o">=</span><span class="s2">"1eae1e11-6902-45f9-9c27-55ab648972b3"</span>
/dev/sda2: <span class="nv">UUID</span><span class="o">=</span><span class="s2">"2cf97347-1baf-4abf-a297-650ebf4dfdff"</span> <span class="nv">TYPE</span><span class="o">=</span><span class="s2">"ext4"</span> <span class="nv">PARTUUID</span><span class="o">=</span><span class="s2">"15ac40fa-5874-423b-9282-209a8b88a60a"</span>
/dev/sda3: <span class="nv">UUID</span><span class="o">=</span><span class="s2">"16a7a205-220c-4583-a758-4fcaf3eb0417"</span> <span class="nv">TYPE</span><span class="o">=</span><span class="s2">"swap"</span> <span class="nv">PARTUUID</span><span class="o">=</span><span class="s2">"fa435c81-ab1e-4192-97ba-e55c08ceb932"</span>
/dev/sdb1: <span class="nv">UUID</span><span class="o">=</span><span class="s2">"f6b5096b-188b-4204-92aa-31e8c58e0eb6"</span> <span class="nv">TYPE</span><span class="o">=</span><span class="s2">"ext4"</span> <span class="nv">PARTUUID</span><span class="o">=</span><span class="s2">"61e5434f-7975-45a8-a8c4-6148fb56f9b4"</span>
</code></pre>
    </div>
  </li>
  <li>
    <p>Append the new disk to /etc/fstab</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">cudmore@debian:~$ </span>more /etc/fstab 
<span class="c"># /etc/fstab: static file system information.</span>
<span class="c">#</span>
<span class="c"># Use 'blkid' to print the universally unique identifier for a</span>
<span class="c"># device; this may be used with UUID= as a more robust way to name devices</span>
<span class="c"># that works even if disks are added and removed. See fstab(5).</span>
<span class="c">#</span>
<span class="c"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span>
<span class="c"># / was on /dev/sda2 during installation</span>
<span class="nv">UUID</span><span class="o">=</span>2cf97347-1baf-4abf-a297-650ebf4dfdff /               ext4    <span class="nv">errors</span><span class="o">=</span>remount-ro 0       1
<span class="c"># /boot/efi was on /dev/sda1 during installation</span>
<span class="nv">UUID</span><span class="o">=</span>30EE-7B6B  /boot/efi       vfat    <span class="nb">umask</span><span class="o">=</span>0077      0       1
<span class="c"># swap was on /dev/sda3 during installation</span>
<span class="nv">UUID</span><span class="o">=</span>16a7a205-220c-4583-a758-4fcaf3eb0417 none            swap    sw              0       0
<span class="c"># 2tb drive for movies</span>
<span class="nv">UUID</span><span class="o">=</span>f6b5096b-188b-4204-92aa-31e8c58e0eb6 /movies ext4 <span class="nv">errors</span><span class="o">=</span>remount-ro 0 1
</code></pre>
    </div>
  </li>
</ul>

<h4 id="users-and-groups">Users and groups</h4>

<ul>
  <li>
    <p>Make a second user ‘user2’</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo adduser user2
</code></pre>
    </div>
  </li>
  <li>
    <p>Make a group ‘movies’</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo addgroup movies
</code></pre>
    </div>
  </li>
  <li>
    <p>Add myself (user1) and user2 to the ‘movies’ group</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo usermod -a -G movies user1
sudo usermod -a -G movies user2
</code></pre>
    </div>
  </li>
</ul>

<h4 id="make-second-harddrive-rwx-for-group-movies">Make second harddrive rwx for group ‘movies’</h4>
<ul>
  <li>
    <p>make sure the second hard drive has rwx permission for group ‘movies’</p>

    <div class="highlighter-rouge"><pre class="highlight"><code># the first 'movies' is the name of the group, the second /movies is the folder
sudo chgrp -R movies /movies
sudo chmod -R g+rwx /movies
</code></pre>
    </div>
  </li>
</ul>

<h4 id="apple-file-protocol-afp">Apple-File-Protocol (afp)</h4>

<ul>
  <li>Follow <a href="http://netatalk.sourceforge.net/wiki/index.php/Install_Netatalk_3.1.7_on_Debian_8_Jessie">debian jessie afp install guide</a></li>
  <li>I am using netatalk-3.1.7</li>
  <li>Modify /usr/local/etc/afp.conf</li>
</ul>

<p>The key here is to specify the name of the mount point using ‘home name = $u_server’. Otherwise your mount point becomes ‘[[user]]’s home’ and programs like Microsoft Word and Fiji will probably not find the path with the apostrophe in the name.</p>

<p>$u is a variable that inserts the current username. It is defined in the <a href="http://netatalk.sourceforge.net/3.0/htmldocs/afp.conf.5.html">afp.conf</a> documentation.</p>

<p>[movie_server] is a mount point that will mount my second hard drive from folder /movies.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>;
; Netatalk 3.x configuration file
;

[Global]
; Global server settings

[Homes]
; basedir regex = /xxxx
;user1 will mount as user1_server
home name = $u_server
basedir regex = /home

; [My AFP Volume]
; path = /path/to/volume

[movies_server]
path = /movies
</code></pre>
</div>

<h4 id="remote-desktop-with-vnc">Remote desktop with vnc</h4>
<ul>
  <li>This is not working. May be jessie bug?</li>
  <li><a href="http://linuxconfig.org/quick-vnc-server-client-setup-on-debian-linux-jessie-8">plagiarized guide</a></li>
</ul>

<h4 id="install-anaconda-python">Install Anaconda (Python)</h4>
<ul>
  <li>Download and follow <a href="http://docs.continuum.io/anaconda/install# linux-install">these</a> instructions on website</li>
</ul>

<h4 id="configure-duckdnshttpswwwduckdnsorg-to-keep-your-externalrouter-ip-up-to-date">Configure <a href="https://www.duckdns.org">duckdns</a> to keep your external/router ip up to date</h4>
<ul>
  <li>Follow <a href="https://www.duckdns.org/install.jsp">this</a></li>
</ul>

<h4 id="install-sambasmb-file-sharing">Install samba/smb file sharing</h4>
<ul>
  <li>Follow something like <a href="https://wiki.debian.org/SambaServerSimple">this</a></li>
  <li>
    <p>edit with ‘sudo pico /etc/samba/smb.conf’</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>[movies_server]
comment = movies on debian server
read only = no
locking = no
path = /path_to_our_files
guest ok = no
</code></pre>
    </div>
  </li>
  <li>Restart samba<br />
<code class="highlighter-rouge">
sudo /etc/init.d/samba restart
</code></li>
</ul>

<h4 id="run-python-scripts-at-boot">Run python scripts at boot</h4>
<ul>
  <li>This is very unclear to me</li>
  <li>
    <p>Directly edit ‘sudo pico /etc/crontab’</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>@reboot root /home/cudmore/anaconda2/bin/python /home/cudmore/Sites/temperatureserver/app.py &gt;&gt; /home/cudmore/Sites/temperatureserver/temperatureserver.log 2&gt;&amp;1
</code></pre>
    </div>
  </li>
  <li>I want this to redirect stdout to the .log file. It is redirecting when it starts up but is not redirecting my ‘print’ statements as it runs?</li>
</ul>

<h4 id="transmission-torrent-download">Transmission (torrent download)</h4>

<p><code class="highlighter-rouge">
  sudo apt-get install transmission
  sudo apt-get install transmission-daemon
 </code></p>

<ul>
  <li>Follow very specific instructions <a href="https://trac.transmissionbt.com/wiki/HeadlessUsage/General">here</a></li>
  <li><a href="https://help.ubuntu.com/community/TransmissionHowTo">this</a> might be more useful.</li>
  <li>
    <p>Modify /var/lib/transmission-daemon/info/settings.json</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>"download-dir": "/movies/transmission_download",
"rpc-whitelist": "127.0.0.1,192.168.*.*",
"rpc-authentication-required": false,
</code></pre>
    </div>
  </li>
  <li>
    <p>Maybe add transmissions user to ‘movies’ group? (movies group was made above).</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo usermod -a -G movies transmission
</code></pre>
    </div>
  </li>
  <li>
    <p>That didn’t work (maybe I needed a -R). Fuck all this security anyways.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo chmod -R a+rwx /movies/transmission_download/
</code></pre>
    </div>
  </li>
  <li>
    <p>Make sure to stop and then start daemon when editing the configuration file.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo service transmission-daemon stop
sudo nano /var/lib/transmission-daemon/info/settings.json
sudo service transmission-daemon start
</code></pre>
    </div>
  </li>
  <li>
    <p>Access transmissions via web interface</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>http://192.168.1.200:9091
</code></pre>
    </div>
  </li>
  <li>
    <p>My downloads were getting user/group debian-transmission. This will add user cudmore to group debian-transmission</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo usermod -a -G debian-transmission cudmore 
</code></pre>
    </div>
  </li>
</ul>

<h4 id="install-particle-cloud-server">Install particle cloud server</h4>

<p>see <a href="http://blog.cudmore.io/post/2015/12/01/particle-cloud-server/">other blog post</a></p>

</div>

<div class="post-tags">
  Tags: 
  
  
  <a href="/tags/#osx">osx</a>,
  
  <a href="/tags/#linux">linux</a>
  
</div>


<div class="post-tags">
    <p><font size="-1rem">&copy;2017. <A HREF="http://robertcudmore.org">Robert Cudmore</A>.</font></p>
</div>


<span class="page-nav-item-left">
    <a rel="prev" href="/post/2015/09/07/remote-sensors/" title="View remote sensors">&laquo; Older</a>
</span>


<span class="page-nav-item-right">
    <a rel="next" href="/post/2015/12/01/particle-cloud-server/" title="View ">Newer &raquo;</a>
</span>



    </div>


  </body>
</html>
