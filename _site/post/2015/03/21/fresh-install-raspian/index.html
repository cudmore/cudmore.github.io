<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Fresh install of Raspian &middot; Robert Cudmore
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!--
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  -->
  
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>





  <body class="layout-reverse">

    <div class="sidebar">
  <div class="container sidebar-sticky">

    
    
    <div id="sidebar">
    <!-- <nav class="sidebar-nav"> -->
      <!-- <a class="sidebar-nav-item" href="">Home</a> -->

      

	  <!-- <script>
  (function() {
    var cx = '014838221913568838622:5bpsoltbvmg';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
 -->

		<section id="article">
		  <span class="sidebar-nav-item">Recent posts</span>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/06/08/Behavioral-acquisition-with-raspberry-arduino-video-and-scan-image/">Behavioral data acquisition with Raspberry, Arduino, Video and ScanImage</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/06/07/Changing-default-mount-in-Apple-File-Sharing/">Changing default mount name in Apple File Sharing</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/05/24/Non-blocking-stepper-motor-on-arduino/">Arduino + stepper motor + rotary encoder + scan image frame clock + serial logging</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/05/05/mounting-a-usb-drive-at-boot/">Mounting a USB drive at boot</a><BR>
		    
		      &raquo; <a class="sidebarlink" href="/post/2015/05/05/X11%20on%20Raspberry/">X11 on raspberry</a><BR>
		    
		</section>

		<BR>

		<span class="sidebar-nav-item">Tag cloud</span>
		
    		<a style="font-size: 76%" href="/tags/#flask">
    		  flask
    		</a>
		
    		<a style="font-size: 130%" href="/tags/#python">
    		  python
    		</a>
		
    		<a style="font-size: 185%" href="/tags/#raspberry pi">
    		  raspberry pi
    		</a>
		
    		<a style="font-size: 112%" href="/tags/#data acquisition">
    		  data acquisition
    		</a>
		
    		<a style="font-size: 58%" href="/tags/#bokeh">
    		  bokeh
    		</a>
		
    		<a style="font-size: 58%" href="/tags/#protocols">
    		  protocols
    		</a>
		
    		<a style="font-size: 76%" href="/tags/#osx">
    		  osx
    		</a>
		
    		<a style="font-size: 94%" href="/tags/#raspberry">
    		  raspberry
    		</a>
		
    		<a style="font-size: 130%" href="/tags/#linux">
    		  linux
    		</a>
		
    		<a style="font-size: 58%" href="/tags/#arduino">
    		  arduino
    		</a>
		
    		<a style="font-size: 58%" href="/tags/#ScanImage">
    		  ScanImage
    		</a>
		

		<BR>
		<BR>

		<section id="article">
		  <span class="sidebar-nav-item">Links</span>
		  &raquo; <a class="sidebarlink" href="http://robertcudmore.org">Homepage</a><BR>
		  &raquo; <a class="sidebarlink" href="https://github.com/cudmore/cudmore.github.io">Blog layout on github</a><BR>
		  &raquo; <a class="sidebarlink" href="http://www.flickr.com/cudmore">Flickr</a><BR>
		</section>
  
	</div>
<!--    </nav> -->

  </div>
</div>


    <div class="content container">

      <!-- added by bob -->
      <div class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">Robert Cudmore</a>

          
              &nbsp;&nbsp;&nbsp;<small><a href="/about">about</a></small>
          
              &nbsp;&nbsp;&nbsp;<small><a href="/archive">archive</a></small>
          
              &nbsp;&nbsp;&nbsp;<small><a href="/tags">tags</a></small>
          
              &nbsp;&nbsp;&nbsp;<small><a href="/software">software</a></small>
          


        </h3>
		<hr style="background:#202020; border:0; height:3px" />
      </div>

      <div class="post">
  <h3 class="post-title">Fresh install of Raspian</h1>
  <span class="post-date">21 Mar 2015</span>
  <p>This is the procedure I follow to install a fresh raspbian system on a Raspberry Pi.</p>

<h3>Preliminaries</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo raspi-config # configure pi with text menu

sudo apt-get update # update database

sudo apt-get upgrade # update userspace

sudo rpi-update # update firmware (requires reboot)
</code></pre></div>
<h3>Apple-File-Protocol (afp)</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install netatalk
</code></pre></div>
<h3>Unison file synchronization</h3>

<p>See my post <a href="http://www.robertcudmore.org/blog/?p=168">here</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install unison
#see link to set up auto authentication with rsa keys
unison #run once to make /home/pi/.unison
pico /home/pi/.unison/sites.prf    

# This is contents of /home/pi/.unison/sites.prf
# Unison preferences file
root = /home/pi/Sites
root = ssh://robertcu@robertcudmore.org/raspberry/Sites

ignore = Name *.tif
ignore = Name .AppleDouble
ignore = Name .DS_Store
ignore = Name *.DS_Store
ignore = Name *.shtml
ignore = Name *.htaccess

# Be fast even on Windows
#fastcheck = yes

servercmd=/home1/robertcu/unison
</code></pre></div>
<h3>Startup mailer</h3>

<p>See my post <a href="http://www.robertcudmore.org/blog/?p=60">here</a>.</p>

<p>Use gmail &#39;<a href="mailto:cudmore.raspberry@gmail.com">cudmore.raspberry@gmail.com</a>&#39; to send  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> wget http://cudmore.github.io/downloads/startup_mailer.py
</code></pre></div>
<h3>What is my ip</h3>

<p>Download whatismyip.py, run it and it will tell you your ip</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">WOOPS, NOT THIS ... wget http://cudmore.github.io/downloads/startup_mailer.py
</code></pre></div>
<h3>python</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install python-dev  
</code></pre></div>
<h3>pip</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install python-pip  
</code></pre></div>
<h3>Flask</h3>

<ul>
<li><p>Flask tutorial <a href="http://mattrichardson.com/Raspberry-Pi-Flask/">here</a>  </p>

<p>sudo pip install flask  </p></li>
</ul>

<h3>socketio for Flask</h3>

<ul>
<li><a href="https://flask-socketio.readthedocs.org/en/latest/">socketio website</a><br></li>
<li><p><a href="http://blog.miguelgrinberg.com/post/easy-websockets-with-flask-and-gevent">socketio tutorial</a>  </p>

<p>sudo pip install flask-socketio  </p></li>
</ul>

<h3>pandas (this takes awhile)</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install python-pandas  
</code></pre></div>
<h3>subversion</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install subversion
</code></pre></div>
<h3>mjpg-streamer</h3>

<p>See my post <a href="http://cudmore.github.io/post/2015/03/15/Installing-mjpg-streamer-on-a-raspberry-pi/">here</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get -y install libjpeg8-dev imagemagick libv4l-dev  
sudo ln -s /usr/include/linux/videodev2.h /usr/include/linux/videodev.h  
wget http://sourceforge.net/code-snapshots/svn/m/mj/mjpg-streamer/code/mjpg-streamer-code-182.zip  
unzip mjpg-streamer-code-182.zip  
cd mjpg-streamer-code-182/mjpg-streamer  
make mjpg_streamer input_file.so input_uvc.so output_http.so  
sudo cp mjpg_streamer /usr/local/bin  
sudo cp output_http.so input_file.so input_uvc.so /usr/local/lib/  
sudo cp -R www /usr/local/www  

sudo apt-get install v4l-utils #this is to detect parameters of USB camera  
</code></pre></div>
<p>Note, make &#39;input_uvc.so&#39; is for usb cam and &#39;input_file&#39; is for raspberry CSI camera  </p>

<p>If wget does not find mjpg-streamer, download it here  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">wget http://cudmore.github.io/downloads/mjpg-streamer-code-182.zip
</code></pre></div>
<h3>opencv</h3>

<p>See my post on open cv <a href="http://cudmore.github.io/post/2015/03/07/use-opencv-to-acquire-video/">here</a>  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install libopencv-dev python-opencv
</code></pre></div>
<h3>PIL</h3>

<p>Not sure if there is apt-get install python-pil ???</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo pip install pil
</code></pre></div>
<h3>Upgrade numpy (takes a long time)</h3>

<ul>
<li><p>required for pandas and bokeh</p>

<p>sudo pip install numpy --upgrade  </p></li>
</ul>

<h3>Install pandas</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install python-pandas  
</code></pre></div>
<h3>Install bokeh</h3>

<ul>
<li><p>To do, get an example running again  </p>

<p>sudo pip install bokeh</p></li>
</ul>

<h3>Install <a href="https://wiki.python.org/moin/PyQt">python-qt4</a></h3>

<p>The list of qt libraries is huge, see <a href="https://www.raspberrypi.org/forums/viewtopic.php?f=32&amp;t=102028">here</a></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo apt-get install python-qt4
sudo apt-get install python-qt4-dev
</code></pre></div>
<h1>!!! Stop Here !!!</h1>

<h3>Client side socket.io javascript</h3>

<p>Client side needs socketio javascript: <a href="http://socket.io">http://socket.io</a><br>
Put this in your Flask project /static/js/<br>
Something like /home/pi/Sites/iosserver/static/js/socket.io.min.js  </p>

<blockquote>
<p>wget <a href="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js">https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js</a><br>
cp socket.io.min.js Sites/iosserver/static/js/</p>
</blockquote>

<h3>Client side jquery</h3>

<p>documentation at: <a href="http://jquery.com/download/">http://jquery.com/download/</a>  </p>

<blockquote>
<p>wget wget <a href="http://code.jquery.com/jquery-1.11.2.min.js">http://code.jquery.com/jquery-1.11.2.min.js</a><br>
cp jquery-1.11.2.min.js Sites/iosserver/static/js/</p>
</blockquote>

<h3>miniconda</h3>

<p>anaconda install tutorial <a href="http://docs.continuum.io/anaconda/install.html">http://docs.continuum.io/anaconda/install.html</a></p>

<blockquote>
<p>wget <a href="http://repo.continuum.io/miniconda/Miniconda-3.5.5-Linux-armv6l.sh">http://repo.continuum.io/miniconda/Miniconda-3.5.5-Linux-armv6l.sh</a>
bash Miniconda-3.5.5-Linux-armv6l.sh</p>

<p>conda update conda
conda update anaconda</p>
</blockquote>

<h3>bokeh</h3>

<p>bokeh quickstart: <a href="http://bokeh.pydata.org/en/latest/docs/quickstart.html">http://bokeh.pydata.org/en/latest/docs/quickstart.html</a>
make sure dependencies are installed: NumPy, Pandas, and Redis</p>

<blockquote>
<p>pip install bokeh</p>
</blockquote>

<h3>Streaming from a webcam or camera module using mjpg streamer</h3>

<p>My home usb video camera shows up as</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">pi@pi50 ~/Sites/iosserver $ lsusb
Bus 001 Device 002: ID 0424:9512 Standard Microsystems Corp. 
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. 
Bus 001 Device 004: ID 1a40:0201 Terminus Technology Inc. FE 2.1 7-port Hub
Bus 001 Device 005: ID 1415:2000 Nam Tai E&amp;E Products Ltd. or OmniVision Technologies, Inc. Sony Playstation Eye
</code></pre></div>
<p>Source code for mjpg streamer</p>

<p><a href="http://sourceforge.net/projects/mjpg-streamer/">http://sourceforge.net/projects/mjpg-streamer/</a></p>

<p>Tutorials</p>

<p><a href="http://jacobsalmela.com/raspberry-pi-webcam-using-mjpg-streamer-over-internet/">http://jacobsalmela.com/raspberry-pi-webcam-using-mjpg-streamer-over-internet/</a></p>

<p><a href="http://blog.miguelgrinberg.com/post/how-to-build-and-run-mjpg-streamer-on-the-raspberry-pi">http://blog.miguelgrinberg.com/post/how-to-build-and-run-mjpg-streamer-on-the-raspberry-pi</a></p>

<h3>my usb webcam has following output</h3>

<ul>
<li><p>v4l2-ctl --list-formats
pi@pi50 ~ $ v4l2-ctl --list-formats
ioctl: VIDIOC_ENUM_FMT
    Index       : 0
    Type        : Video Capture
    Pixel Format: &#39;YUYV&#39;
    Name        : YUYV</p></li>
<li><p>v4l2-ctl --list-ctrls
pi@pi50 ~ $ v4l2-ctl --list-ctrls</p>

<p>User Controls</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">                 brightness (int)    : min=0 max=255 step=1 default=0 value=0 flags=slider
                   contrast (int)    : min=0 max=255 step=1 default=32 value=32 flags=slider
                 saturation (int)    : min=0 max=255 step=1 default=64 value=64 flags=slider
                        hue (int)    : min=-90 max=90 step=1 default=0 value=0 flags=slider
    white_balance_automatic (bool)   : default=1 value=1
                   exposure (int)    : min=0 max=255 step=1 default=120 value=120 flags=inactive, volatile
             gain_automatic (bool)   : default=1 value=1 flags=update
                       gain (int)    : min=0 max=63 step=1 default=20 value=20 flags=inactive, volatile
            horizontal_flip (bool)   : default=0 value=0
              vertical_flip (bool)   : default=0 value=0
       power_line_frequency (menu)   : min=0 max=1 default=0 value=0
                  sharpness (int)    : min=0 max=63 step=1 default=0 value=0 flags=slider
</code></pre></div>
<p>Camera Controls</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">              auto_exposure (menu)   : min=0 max=1 default=0 value=0 flags=update
</code></pre></div></li>
</ul>

<p>-mjpg_streamer --input &quot;input_uvc.so --help&quot;
    pi@pi50 ~ $ mjpg_streamer --input &quot;input_uvc.so --help&quot;
    MJPG Streamer Version: svn rev: Unversioned directory
     ---------------------------------------------------------------
     Help for input plugin..: UVC webcam grabber
     ---------------------------------------------------------------
     The following parameters can be passed to this plugin:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> [-d | --device ].......: video device to open (your camera)
 [-r | --resolution ]...: the resolution of the video device,
                          can be one of the following strings:
                          QSIF QCIF CGA QVGA CIF VGA 
                          SVGA XGA SXGA 
                          or a custom value like the following
                          example: 640x480
 [-f | --fps ]..........: frames per second
 [-y | --yuv ]..........: enable YUYV format and disable MJPEG mode
 [-q | --quality ]......: JPEG compression quality in percent 
                          (activates YUYV format, disables MJPEG)
 [-m | --minimum_size ].: drop frames smaller then this limit, useful
                          if the webcam produces small-sized garbage frames
                          may happen under low light conditions
 [-n | --no_dynctrl ]...: do not initalize dynctrls of Linux-UVC driver
 [-l | --led ]..........: switch the LED &quot;on&quot;, &quot;off&quot;, let it &quot;blink&quot; or leave
                          it up to the driver using the value &quot;auto&quot;
 ---------------------------------------------------------------

input_init() return value signals to exit
</code></pre></div>
<h1>THIS WORKS FOR USB WEBCAM</h1>
<div class="highlight"><pre><code class="language-text" data-lang="text">/usr/local/bin/mjpg_streamer -i &quot;/usr/local/lib/input_uvc.so -y&quot; -o &quot;/usr/local/lib/output_http.so -w /usr/local/www&quot;

/usr/local/bin/mjpg_streamer -i &quot;/usr/local/lib/input_uvc.so -y&quot; -o &quot;/usr/local/lib/output_http.so -w /usr/local/www&quot;

/usr/local/bin/mjpg_streamer -i &quot;/usr/local/lib/input_uvc.so -y&quot; -o &quot;/usr/local/lib/output_http.so -w /usr/local/www&quot;
</code></pre></div>
</div>

<div class="post-tags">
  Tags: 
  
    
  
  
  <a href="/tags/#raspberry pi">raspberry pi</a>
  
</div>


<div class="post-tags">
    <p><font size="-1rem">&copy;2015. <A HREF="http://robertcudmore.org">Robert Cudmore</A>.</font></p>
</div>


<span class="page-nav-item-left">
    <a rel="prev" href="/post/2015/03/20/Rapsberry%20Pi%20Video%20Controller/" title="View Raspberry Pi video controller">&laquo; Older</a>
</span>


<span class="page-nav-item-right">
    <a rel="next" href="/post/2015/03/27/lab-protocols/" title="View ">Newer &raquo;</a>
</span>



    </div>

  </body>
</html>
